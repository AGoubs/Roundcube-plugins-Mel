function rcube_mail_ui(){function a(a){if(D||(D=rcmail.local_storage_get_item("prefs.larry",{})),null==D[a]){var b=rcmail.get_cookie(a);null!=b&&(D[a]=b,rcmail.local_storage_set_item("prefs.larry",D)&&rcmail.set_cookie(a,b,new Date))}return D[a]}function b(a,b){if(D[a]=b,!rcmail.local_storage_set_item("prefs.larry",D)){var c=new Date;c.setYear(c.getFullYear()+1),rcmail.set_cookie(a,b,c)}}function c(a){var b=a?10:0;rcmail.resize_timeout&&window.clearTimeout(rcmail.resize_timeout),rcmail.resize_timeout=window.setTimeout(function(){"mail"==rcmail.env.task&&("show"==rcmail.env.action||"preview"==rcmail.env.action?f():"compose"==rcmail.env.action&&k()),$("body.iframe .footerleft").each(function(){var a=$(this),b=$(document.body),c=a.hasClass("floating"),d=b.outerHeight(!0)>$(window).height();if(d!=c){var e=d?"addClass":"removeClass";a[e]("floating"),b[e]("floatingbuttons")}})},b)}function d(a){var b=$(a.object).siblings("div");if(b.length&&$(a.object).insertBefore(b.first()),"error"==a.type&&"login"!=rcmail.env.task){rcmail.hide_message(a.object),H.message_timer&&window.clearTimeout(H.message_timer),H.messagedialog||(H.messagedialog=$("<div>").addClass("popupdialog").hide());var c=a.message,d=function(){H.messagedialog.is(":visible")&&H.messagedialog.dialog("destroy").hide()};H.messagedialog.is(":visible")&&H.messagedialog.text()!=c&&(c=H.messagedialog.html()+"<p>"+a.message+"</p>"),H.messagedialog.html(c).dialog({resizable:!1,closeOnEscape:!0,dialogClass:a.type,title:rcmail.gettext("errortitle"),close:d,hide:{effect:"fadeOut"},width:420,minHeight:90}).show(),H.messagedialog.closest("div[role=dialog]").attr("role","alertdialog"),0<a.timeout&&(H.message_timer=window.setTimeout(d,a.timeout))}}function e(a){var b=a?a.new_layout:rcmail.env.layout,c=$("#mailview-top"),d=$("#mailview-bottom");a&&$("#mainscreencontent").removeClass().addClass(b),$("#mailviewsplitter")["desktop"==b?"show":"hide"](),$("#mailviewsplitter2")["widescreen"==b?"show":"hide"](),$("#mailpreviewframe")["list"==b?"hide":"show"](),rcmail.env.contentframe="list"==b?null:"messagecontframe","widescreen"==b?($("#countcontrols").detach().appendTo($("#messagelistheader")),c.css({height:"auto",width:394}),d.css({top:0,left:406,height:"auto"}).show(),C?C.resize():(C=new rcube_splitter({id:"mailviewsplitter2",p1:"#mailview-top",p2:"#mailview-bottom",orientation:"v",relative:!0,start:416,min:400,size:0}),C.init())):"desktop"==b?(c.css({height:270,width:"auto"}),d.css({left:0,top:284,height:"auto"}).show(),B?B.resize():(B=new rcube_splitter({id:"mailviewsplitter",p1:"#mailview-top",p2:"#mailview-bottom",orientation:"h",relative:!0,start:276,min:150,size:0,offset:4}),B.init())):(c.css({height:"auto",width:"auto"}),d.hide()),a&&"widescreen"==a.old_layout&&$("#countcontrols").detach().appendTo($("#messagelistfooter"))}function f(){$("#messagecontent").css("top",$("#messageheader").outerHeight()+1+"px"),$("#message-objects div a").addClass("button"),$("#attachment-list li").length||($("div.rightcol").hide().attr("aria-hidden","true"),$("div.leftcol").css("margin-right","0"));var a=$("#messagebody.mailvelope, #messagebody > .mailvelope");if(a.length){var b=$("#messagecontent").length?$("#messagecontent").height()-16:$(window).height()-a.offset().top-2;a.height(b)}}function g(){}function i(){}function j(a){if("TEXTAREA"==a.nodeName){var b=$(a),c=a.scrollHeight,d=80<a.value.length&&30<c?2:1;b.css("height",20*d+"px"),k()}}function k(){var a,b,c,d,e=$("#composebody"),f=$("#compose-content"),g=$("#composeview-bottom"),i=0,c=f.height()-g.position().top;d=300-c,i=-100<d?0:40,g.height(Math.max(300,c)),f.css("overflow",0<d?"auto":"hidden"),a=e.parent().width()-5,b=e.parent().height()-8,e.width(a).height(b),$("#composebodycontainer > div").width(a+8),$("#composebody_ifr").height(b+4-$("div.mel-toolbar").height()),$("#googie_edit_layer").width(a).height(b);var j=$("#directorylist");j.length&&$("#compose-contacts .scroller").css("top",j.position().top+j.outerHeight()),$("#composeview-bottom").css({top:$("#composeheaders").height()+5+"px"})}function l(a){var b=$("#quotadisplay"),c=$("#quotamenu"),d=a.total?24*Math.ceil(20*(a.percent/100)):0;a.total&&480==d&&100>a.percent&&(d-=24),b.css("background-position","0 -"+d+"px"),b.attr("class","countdisplay p"+10*Math.round(a.percent/10)),a.table&&(!c.length&&(c=$("<div id=\"quotamenu\" class=\"popupmenu\">").appendTo($("body"))),c.html(a.table),b.css("cursor","pointer").off("click").on("click",function(a){return rcmail.command("menu-open","quotamenu",a.target,a)})),rcmail.gui_objects.quotadisplay&&a&&"text"==a.type&&$(rcmail.gui_objects.quotadisplay).text(a.title)}function m(a){$(".boxtitle a.search",a).click(function(){var b=$(".boxtitle",a),c=$(".listsearchbox",a),d=c.is(":visible")?-1:1,e=34+($("select",c).length?22:0);return c.slideToggle({duration:160,progress:function(c,f){0>d&&(f=1-f),$(".scroller",a).css("top",b.outerHeight()+e*f+"px")},complete:function(){c.toggleClass("expanded"),c.is(":visible")?(c.find("input[type=text]").focus(),e=34+($("select",c).length?$("select",c).outerHeight()+4:0),$(".scroller",a).css("top",b.outerHeight()+e+"px")):$("a.reset",c).click()}}),!1})}function n(a){if("reply-list"==a.command&&1==rcmail.env.reply_all_mode){var b=rcmail.gettext(a.status?"replylist":"replyall");"preview"==rcmail.env.action?$("a.button.replyall").attr("title",b):$("a.button.reply-all").text(b).attr("title",b)}else"compose-encrypted"==a.command&&$("a.button.encrypt").show()}function o(a,b){var c=F[a]=$("#"+a);c.appendTo(document.body),c.length&&(G[a]=$.extend(G[a]||{},b||{}))}function p(a,b){(b||!$("#mail"+a+"mode").hasClass("disabled"))&&($("#maillistmode, #mailthreadmode").removeClass("selected").attr("tabindex","0").attr("aria-disabled","false"),$("#mail"+a+"mode").addClass("selected").attr("tabindex","-1").attr("aria-disabled","true"))}function q(a){if(a&&"messagelistmenu"==a.name)t(a);else if(a){var b=G[a.name]||{},c=$(b.link||"#"+a.name+"link"),d=a.obj&&a.obj.is(":visible"),e=b.above;if(a.obj&&d&&c.length){var f,g=c.parent(),i=$(window);g.hasClass("dropbutton")&&(c=g),(b.above||c.hasClass("dropbutton"))&&(f=c.offset(),a.obj.css({left:f.left+"px",top:f.top+(b.above?-a.obj.height():c.outerHeight())+"px"}))}a.obj&&b.iconized&&a.obj.children("ul").addClass("iconized"),a.obj&&b.editable&&a.obj.attr("data-editable","true"),"function"==typeof b.callback&&b.callback(d,a)}}function r(a,b){var c=a.parentNode.id.replace(/^attach/,"");$.each(["open","download","rename"],function(){var a=this;$("#attachmenu"+a).off("click").attr("onclick","").click(function(){return rcmail.command(a+"-attachment",c,this)})}),G.attachmentmenu.link=a,rcmail.command("menu-open",{menu:"attachmentmenu",id:c},a,b)}function s(a){a=$(a),a.children(".drop").length||a.append($("<a class=\"drop skip-content\" tabindex=\"0\" aria-haspopup=\"true\">Show options</a>").on("click keypress",function(a){if("keypress"!=a.type||13==rcube_event.get_keycode(a))return r(this,a),!1}))}function t(a){var b=$("#listoptions");return b.is(":visible")?void b.dialog("close",a.originalEvent):void($("input[name=\"sort_col\"][value=\""+rcmail.env.sort_col+"\"]").prop("checked",!0),$("input[name=\"sort_ord\"][value=\"DESC\"]").prop("checked","DESC"==rcmail.env.sort_order),$("input[name=\"sort_ord\"][value=\"ASC\"]").prop("checked","DESC"!=rcmail.env.sort_order),$.each(["widescreen","desktop","list"],function(){$("input[name=\"layout\"][value=\""+this+"\"]").prop("checked",rcmail.env.layout==this)}),$("#listoptions-columns",b)["widescreen"==rcmail.env.layout?"hide":"show"](),$("input[name=\"list_col[]\"]").each(function(){$(this).prop("checked",-1!=$.inArray(this.value,rcmail.env.listcols))}),b.dialog({modal:!0,resizable:!1,closeOnEscape:!0,title:null,open:function(){setTimeout(function(){b.find("a, input:not(:disabled)").not("[aria-disabled=true]").first().focus()},100)},close:function(a){b.dialog("destroy").hide(),a.originalEvent&&rcube_event.is_keyboard(a.originalEvent)&&$("#listmenulink").focus()},minWidth:500,width:b.width()+25}).show())}function u(a){$("#listoptions").dialog("close"),rcube_event.is_keyboard(a.originalEvent)&&$("#listmenulink").focus();var b=$("input[name=\"sort_col\"]:checked").val(),c=$("input[name=\"sort_ord\"]:checked").val(),d=$("input[name=\"layout\"]:checked").val(),e=$("input[name=\"list_col[]\"]:checked").map(function(){return this.value}).get();rcmail.set_list_options(e,b,c,rcmail.env.threading,d)}function v(){var a=$("#contacts-table"),b=a.parent().css("overflow","hidden");a.clone().css({position:"absolute",top:"0",left:"0",width:a.width()+"px","z-index":10}).appendTo(b).animate({left:-(a.width()+5)+"px"},300,"swing",function(){$(this).remove(),b.css("overflow","auto")})}function w(){var a=$("#contacts-table"),b=a.parent().css("overflow","hidden"),c=a.clone().appendTo(b);a.css({position:"absolute",top:"0",left:-(a.width()+5)+"px",width:a.width()+"px",height:a.height()+"px","z-index":10}).animate({left:"0"},300,"linear",function(){c.remove(),$(this).css({position:"relative",left:"0",width:"100%",height:"auto","z-index":1}),b.css("overflow","auto")})}function x(){var a=$("#upload-dialog");return a.is(":visible")?void a.dialog("close"):void(rcmail.mailvelope_editor||("compose"==rcmail.env.action&&!a.data("extended")&&($("<a>").addClass("iconlink add").attr("href","#add").html("Add").appendTo($("input[type=\"file\"]",a).parent()).click(y),a.data("extended",!0)),a.dialog({modal:!0,resizable:!1,closeOnEscape:!0,title:a.attr("title"),open:function(){document.all||$("input[type=file]",a).first().click()},close:function(){try{$("#upload-dialog form").get(0).reset()}catch(a){}a.dialog("destroy").hide(),$("div.addline",a).remove()},width:480}).show()))}function y(){var a=$(this).parent(),b=a.clone().addClass("addline").insertAfter(a);b.children(".iconlink").click(y),b.children("input").val(""),document.all||$("input[type=file]",b).click()}function z(a,b){var c=$("#compose-"+a);if(!c.is(":visible"))return I[a]&&!b&&$("#_"+a).val(I[a]),c.show(),$("#"+a+"-link").hide(),k(),$("input,textarea",c).focus(),!1}function A(a,b){var d=$(a),e=d.get(0).id,f=d.children("fieldset");if(f.length){e||(e="rcmtabcontainer",d.attr("id",e));var g=$("<ul>").addClass("tabsbar").prependTo(d);f.each(function(b){var c,d,f=$(this),i=f.children("legend"),j=e+"-t"+b;d=$("<a>").text(i.text()).attr("href","#"+j),c=$("<li>").addClass("tablink"),i.remove(),f.attr("id",j),c.append(d).appendTo(g)}),d.tabs({active:b||0,heightStyle:"content",activate:function(){c()}})}}var B,C,D,E={},F={},G={forwardmenu:{editable:1},searchmenu:{editable:1,callback:function(a){if(a&&rcmail.env.search_mods){var b,c,d=F.searchmenu,e=$("input:checkbox[name=\"s_mods[]\"]",d),f=rcmail.env.mailbox,g=rcmail.env.search_mods,i=rcmail.env.search_scope||"base";if("mail"==rcmail.env.task?("all"==i&&(f="*"),g=g[f]?g[f]:g["*"],c="text",$("input:radio[name=\"s_scope\"]").prop("checked",!1).filter("#s_scope_"+i).prop("checked",!0)):c="*",g[c])e.map(function(){this.checked=!0,this.disabled=this.value!=c});else for(b in e.prop("disabled",!1).prop("checked",!1),g)$("#s_mod_"+b).prop("checked",!0)}}},attachmentmenu:{},listoptions:{editable:1},groupmenu:{above:1},mailboxmenu:{above:1},spellmenu:{callback:function(a,b){var c,d,e,f=rcmail.spellcheck_lang(),g=$("ul",b.obj);if(!g.length){for(c in g=$("<ul class=\"toolbarmenu selectable\" role=\"menu\">"),rcmail.env.spell_langs)e=$("<li role=\"menuitem\">"),d=$("<a href=\"#"+c+"\" tabindex=\"0\"></a>").text(rcmail.env.spell_langs[c]).addClass("active").data("lang",c).on("click keypress",function(a){if("keypress"!=a.type||13==rcube_event.get_keycode(a))return rcmail.spellcheck_lang_set($(this).data("lang")),rcmail.hide_menu("spellmenu",a),!1}),d.appendTo(e),e.appendTo(g);g.appendTo(b.obj)}$("li",g).each(function(){var a=$("a",this);a.data("lang")==f?a.addClass("selected").attr("aria-selected","true"):a.hasClass("selected")&&a.removeClass("selected").removeAttr("aria-selected")})}},"folder-selector":{iconized:1}},H=this,I={};if(this.set=function(a,b){E[a]=b},this.init=function(){if(rcmail.addEventListener("message",d),$("#taskbar a").each(function(a,b){$(b).append("<span class=\"tooltip\">"+$(".button-inner",this).html()+"</span>")}),$("#taskbar .minmodetoggle").click(function(){var a=$(document.body).toggleClass("minimal").hasClass("minimal");b("minimalmode",a?1:0),$(window).resize()}),"mail"==rcmail.env.task){rcmail.addEventListener("menu-open",q).addEventListener("menu-close",q).addEventListener("menu-save",u).addEventListener("enable-command",n).addEventListener("responseafterlist",function(){p(rcmail.env.threading?"thread":"list",!0)}).addEventListener("responseaftersearch",function(){p(rcmail.env.threading?"thread":"list",!0)});var o=$("#dragmessagemenu");if(o.length&&(rcmail.gui_object("dragmenu","dragmessagemenu"),F.dragmenu=o),"show"==rcmail.env.action||"preview"==rcmail.env.action)rcmail.addEventListener("aftershow-headers",function(){f()}).addEventListener("afterhide-headers",function(){f()}),$("#attachment-list > li").each(function(){s(this)}),"show"==rcmail.env.action&&$("#messagecontent").focus();else if("compose"==rcmail.env.action){rcmail.addEventListener("aftersend-attachment",x).addEventListener("fileappended",function(a){a.attachment.complete&&s(a.item)}).addEventListener("aftertoggle-editor",function(a){window.setTimeout(function(){k()},200),a&&a.mode&&$("select[name='editorSelector']").val(a.mode)}).addEventListener("compose-encrypted",function(a){$("select[name='editorSelector']").prop("disabled",a.active),$("a.button.attach, a.button.responses")[a.active?"addClass":"removeClass"]("disabled"),$("#responseslist a.insertresponse")[a.active?"removeClass":"addClass"]("active")});var r,t,y,B=["cc","bcc","replyto","followupto"];for(r=0;r<B.length;r++)t=B[r],y=$("#_"+t),y.length&&(y.on("change",{v:t},function(a){this.value&&z(a.data.v,!0)}),""!=y.val()&&z(t,!0));$("#composeoptionstoggle").click(function(a){var c=$("#composeoptions").toggle().is(":visible");return $("#composeoptionstoggle").toggleClass("remove").attr("aria-expanded",c?"true":"false"),k(),b("composeoptions",c?"1":"0"),rcube_event.is_keyboard(a)||this.blur(),$("#composeview-bottom").css({top:$("#composeheaders").height()+5+"px"}),k(),!1}).css("cursor","pointer"),"0"!==a("composeoptions")&&$("#composeoptionstoggle").click(),$("#attachment-list li").length&&$("#compose-attachments").show(),$("textarea[name='_to'], textarea[name='_cc'], textarea[name='_bcc']").change(function(){j(this)}).change(),rcmail.addEventListener("autocomplete_insert",function(a){j(a.field)});var C=rcmail.opener();C&&"compose"==C.env.action&&$("#composeoptionstoggle",opener.document).hasClass("remove")&&$("#composeoptionstoggle").click(),$("#attachment-list > li").each(function(){s(this)})}else"list"!=rcmail.env.action&&rcmail.env.action?"get"==rcmail.env.action&&new rcube_splitter({id:"mailpartsplitterv",p1:"#messagepartheader",p2:"#messagepartcontainer",orientation:"v",relative:!0,start:226,min:150,size:0}).init():(e(),$("#maillistmode").addClass(rcmail.env.threading?"":"selected").click(function(){return p("list"),!1}),$("#mailthreadmode").addClass(rcmail.env.threading?"selected":"").click(function(){return p("thread"),!1}),rcmail.init_pagejumper("#pagejumper"),rcmail.addEventListener("setquota",l).addEventListener("layout-change",e).addEventListener("afterimport-messages",x));$("#mailview-left").length&&new rcube_splitter({id:"mailviewsplitterv",p1:"#mailview-left",p2:"#mailview-right",orientation:"v",relative:!0,start:206,min:150,size:0,callback:g,render:i}).init()}else if("settings"==rcmail.env.task){if(rcmail.addEventListener("init",function(){var a="#settingstabpreferences";rcmail.env.action&&(a="#settingstab"+(0<rcmail.env.action.indexOf("identity")?"identities":rcmail.env.action.replace(/\./g,""))),$(a).addClass("selected").children().first().removeAttr("onclick").click(function(){return!1})}),"folders"==rcmail.env.action)new rcube_splitter({id:"folderviewsplitter",p1:"#folderslist",p2:"#folder-details",orientation:"v",relative:!0,start:266,min:180,size:1}).init(),rcmail.addEventListener("setquota",l),m($("#folderslist"));else if("identities"==rcmail.env.action)new rcube_splitter({id:"identviewsplitter",p1:"#identitieslist",p2:"#identity-details",orientation:"v",relative:!0,start:266,min:180,size:1}).init();else if("responses"==rcmail.env.action)new rcube_splitter({id:"responseviewsplitter",p1:"#identitieslist",p2:"#identity-details",orientation:"v",relative:!0,start:266,min:180,size:1}).init();else if("preferences"==rcmail.env.action||!rcmail.env.action)new rcube_splitter({id:"prefviewsplitter",p1:"#sectionslist",p2:"#preferences-box",orientation:"v",relative:!0,start:266,min:180,size:1}).init();else if("edit-prefs"==rcmail.env.action){var D=$("#preferences-details fieldset.advanced legend"),E=$("<a href=\"#toggle\"></a>").text(rcmail.gettext("toggleadvancedoptions")).attr("title",rcmail.gettext("toggleadvancedoptions")).addClass("advanced-toggle");D.click(function(){E.html($(this).hasClass("collapsed")?"&#9650;":"&#9660;"),$(this).toggleClass("collapsed").closest("fieldset").children(".propform").toggle()}).append(E).addClass("collapsed"),bw.mz&&D.parents("form").css("display","inline")}}else if("addressbook"==rcmail.env.task){rcmail.addEventListener("afterupload-photo",x).addEventListener("beforepushgroup",v).addEventListener("beforepopgroup",w).addEventListener("menu-open",q).addEventListener("menu-close",q),(""==rcmail.env.action||"plugin.annuaire"==rcmail.env.action)&&(new rcube_splitter({id:"addressviewsplitterd",p1:"#addressview-left",p2:"#addressview-right",orientation:"v",relative:!0,start:206,min:150,size:1,render:i}).init(),new rcube_splitter({id:"addressviewsplitter",p1:"#addresslist",p2:"#contacts-box",orientation:"v",relative:!0,start:266,min:260,size:1}).init());var o=$("#dragcontactmenu");o.length&&(rcmail.gui_object("dragmenu","dragcontactmenu"),F.dragmenu=o)}$(".tabbed").each(function(a,b){A(b)}),$("select.decorated").each(function(){if(bw.opera)return void $(this).removeClass("decorated");var a=$(this),b=a.parent(),c=Math.max(a.height(),26)-2,d=a.width()-22,e=$("option",this).first().text();""!=$("option:selected",this).val()&&(e=$("option:selected",this).text());var f=$("<a class=\"menuselector\" tabindex=\"-1\"><span class=\"handle\">"+e+"</span></a>").css("position","absolute").offset(a.position()).insertAfter(a);f.children().width(d).height(c).css("line-height",c-1+"px"),"absolute"!=b.css("position")&&b.css("position","relative"),a.width(f.width()).on(bw.mz?"change keyup":"change",function(){var a=$("option:selected",this).text();$(this).next().children().text(a)}),a.on("focus",function(){f.addClass("focus")}).on("blur",function(){f.removeClass("focus")})});var G=$("body.minwidth");G.length&&G.css("min-width",$(".toolbar").width()+$("#quicksearchbar").width()+$("#searchfilter").width()+30),window.onresize=c,c()},this.init_tabs=A,this.show_about=function(a){var b=$("<iframe>").attr({id:"aboutframe",src:rcmail.url("settings/about"),frameborder:"0"});h=Math.floor(.75*$(window).height()),buttons={},supportln=$("#supportlink"),supportln.length&&(E.supporturl=supportln.attr("href"))&&(buttons[supportln.html()]=function(){0>E.supporturl.indexOf("mailto:")?window.open(E.supporturl):location.href=E.supporturl}),b.dialog({modal:!0,resizable:!1,closeOnEscape:!0,title:a?a.title||a.innerHTML:null,close:function(){b.dialog("destroy").remove()},buttons:buttons,width:640,height:h}).width(640)},this.show_popup=function(a,b,c){(c||!G[a])&&o(a,c),c=G[a]||{};var d=$(c.link?c.link:"#"+a+"link"),e=d.offset();return d.has(".inner")&&(d=d.children(".inner")),rcmail.command("menu-open",{menu:a,show:b},d.get(0),$.Event("click",{target:d.get(0),pageX:e.left,pageY:e.top,clientX:e.left,clientY:e.top}))},this.toggle_popup=function(a,b,c){return(c||!G[a])&&o(a,c),rcmail.command("menu-open",a,b.target,b)},this.add_popup=o,this.set_searchmod=function(a){var b,c,d=rcmail.env.task,e=rcmail.env.search_mods,f=rcmail.env.mailbox,g=$("input[name=\"s_scope\"]:checked").val();"all"==g&&(f="*"),e||(e={}),"mail"==d?(!e[f]&&(e[f]=rcube_clone_object(e["*"])),c=e[f],b="text"):(c=e,b="*"),a.checked?c[a.value]=1:delete c[a.value],a.value==b&&$("input:checkbox[name=\"s_mods[]\"]").map(function(){this==a||(this.checked=!0,a.checked?(this.disabled=!0,delete c[this.value]):(this.disabled=!1,c[this.value]=1))}),rcmail.set_searchmods(c)},this.set_searchscope=function(a){"all"==a.value?$("#quicksearchbox").attr("placeholder",rcmail.get_label("mel_larry.search_in_all_folders")):$("#quicksearchbox").attr("placeholder",rcmail.get_label("mel_larry.search_in")+" "+$("#folderlist-content #mailboxlist li.mailbox.selected > a").clone().children().remove().end().text()),rcmail.set_searchscope(a.value)},this.show_uploadform=x,this.show_header_row=z,this.hide_header_row=function(a){var b=$("#_"+a);return I[a]=b.val(),b.val(""),$("#compose-"+a).hide(),$("#"+a+"-link").show(),k(),!1},this.update_quota=l,this.get_pref=a,this.save_pref=b,this.folder_search_init=m,window.$&&document.body){var J=a("minimalmode");(parseInt(J)||null===J&&850>$(window).height())&&$(document.body).addClass("minimal"),bw.tablet&&$("#viewport").attr("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"),$(document).ready(function(){H.init()})}}function rcube_scroller(a,b,c){var d=this;this.list=$(a),this.top=$(b),this.bottom=$(c),this.step_size=6,this.step_time=20,this.delay=500,this.top.mouseenter(function(){rcmail.drag_active&&(d.ts=window.setTimeout(function(){d.scroll("down")},d.delay))}).mouseout(function(){d.ts&&window.clearTimeout(d.ts)}),this.bottom.mouseenter(function(){rcmail.drag_active&&(d.ts=window.setTimeout(function(){d.scroll("up")},d.delay))}).mouseout(function(){d.ts&&window.clearTimeout(d.ts)}),this.scroll=function(a){var b=this,c=this.step_size;rcmail.drag_active&&("down"==a&&(c*=-1),this.list.get(0).scrollTop+=c,this.ts=window.setTimeout(function(){b.scroll(a)},this.step_time))}}function rcube_splitter(a){function b(){(bw.konq||bw.chrome||bw.safari)&&(document.body.style.webkitUserSelect="none"),g.p1pos=g.relative?g.p1.position():g.p1.offset(),g.p2pos=g.relative?g.p2.position():g.p2.offset(),g.drag_active=!0,$(document).on("mousemove."+this.id,c).on("mouseup."+this.id,e),rcmail.message_list&&(rcmail.message_list.drag_active=!0),$("iframe").each(function(a,b){$("<div>").attr("id","iframe-splitter-fix-"+a).addClass("iframe-splitter-fix").css({background:"#fff",width:b.offsetWidth+"px",height:b.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css($(this).offset()).appendTo("body")})}function c(a){return!!g.drag_active&&(window.clearTimeout(g.ts),g.ts=window.setTimeout(function(){d(a)},1),!1)}function d(a){var b=rcube_event.get_mouse_pos(a);if(g.relative){var c=g.parent.offset();b.x-=c.left,b.y-=c.top}g.horizontal?b.y-g.halfsize>g.p1pos.top&&b.y+g.halfsize<g.p2pos.top+g.p2.outerHeight()&&(g.pos=Math.max(g.min,b.y-Math.max(0,g.offset)),g.pos>g.min&&(g.pos=Math.min(g.pos,g.parent.height()-g.min)),g.resize()):b.x-g.halfsize>g.p1pos.left&&b.x+g.halfsize<g.p2pos.left+g.p2.outerWidth()&&(g.pos=Math.max(g.min,b.x-Math.max(0,g.offset)),g.pos>g.min&&(g.pos=Math.min(g.pos,g.parent.width()-g.min)),g.resize()),g.p1pos=g.relative?g.p1.position():g.p1.offset(),g.p2pos=g.relative?g.p2.position():g.p2.offset()}function e(a){return(bw.konq||bw.chrome||bw.safari)&&(document.body.style.webkitUserSelect="auto"),$(document).off("."+g.id),g.drag_active=!1,rcmail.message_list&&(rcmail.message_list.drag_active=!1),$("div.iframe-splitter-fix").remove(),g.set_cookie(),"function"==typeof g.callback&&g.callback(g),!!bw.safari||rcube_event.cancel(a)}function f(){if(g.horizontal){var a=parseInt(g.parent.outerHeight(),10)-parseInt(g.p2[0].style.top,10);g.p2.css("height",(0<a?a:0)+"px")}else{var b=parseInt(g.parent.outerWidth(),10)-parseInt(g.p2[0].style.left,10);g.p2.css("width",(0<b?b:0)+"px")}}this.p=a,this.id=a.id,this.horizontal="horizontal"==a.orientation||"h"==a.orientation,this.halfsize=(a.size===void 0?10:a.size)/2,this.pos=a.start||0,this.min=a.min||20,this.offset=a.offset||0,this.relative=!!a.relative,this.drag_active=!1,this.render=a.render,this.callback=a.callback;var g=this;rcube_splitter._instances[this.id]=g,this.init=function(){if(this.p1=$(this.p.p1),this.p2=$(this.p.p2),this.parent=this.p1.parent(),this.p1.length&&this.p2.length){if(this.p1pos=this.relative?this.p1.position():this.p1.offset(),this.p2pos=this.relative?this.p2.position():this.p2.offset(),this.handle=$("<div>").attr("id",this.id).attr("unselectable","on").attr("role","presentation").addClass("splitter "+(this.horizontal?"splitter-h":"splitter-v")).appendTo(this.parent).mousedown(b),this.horizontal){var a=this.p1pos.top+this.p1.outerHeight();this.handle.css({left:"0px",top:a+"px"})}else{var c=this.p1pos.left+this.p1.outerWidth();this.handle.css({left:c+"px",top:"0px"})}bw.ie&&$(window).resize(f);var d=this.get_cookie();d&&!isNaN(d)?(this.pos=parseFloat(d),this.resize()):this.pos&&(this.resize(),this.set_cookie())}},this.resize=function(){if(this.horizontal){if(this.p1.css("height",Math.floor(this.pos-this.p1pos.top-Math.floor(this.halfsize))+"px"),this.p2.css("top",Math.ceil(this.pos+Math.ceil(this.halfsize)+2)+"px"),this.handle.css("top",Math.round(this.pos-this.halfsize+this.offset)+"px"),bw.ie){var a=parseInt(this.parent.outerHeight(),10)-parseInt(this.p2.css("top"),10);this.p2.css("height",(0<a?a:0)+"px")}}else if(this.p1.css("width",Math.floor(this.pos-this.p1pos.left-Math.floor(this.halfsize))+"px"),this.p2.css("left",Math.ceil(this.pos+Math.ceil(this.halfsize))+"px"),this.handle.css("left",Math.round(this.pos-this.halfsize+this.offset+3)+"px"),bw.ie){var b=parseInt(this.parent.outerWidth(),10)-parseInt(this.p2.css("left"),10);this.p2.css("width",(0<b?b:0)+"px")}this.p2.resize(),this.p1.resize(),this.drag_active&&$("iframe").each(function(a,b){var c=$(this).offset();$("#iframe-splitter-fix-"+a).css({top:c.top+"px",left:c.left+"px",width:b.offsetWidth+"px",height:b.offsetHeight+"px"})}),"function"==typeof this.render&&this.render(this)};this.get_cookie=function(){return window.UI?UI.get_pref(this.id):null},this.set_cookie=function(){window.UI&&UI.save_pref(this.id,this.pos)}}rcube_splitter._instances={},rcube_splitter.get_instance=function(a){return rcube_splitter._instances[a]};